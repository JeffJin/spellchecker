<!DOCTYPE html>
<html>
<head>
    <title>Form test</title>
    <link rel="shortcut icon" type="image/png" href="lib/jasmine/jasmine_favicon.png">
    <link rel="stylesheet" type="text/css" href="lib/jasmine/jasmine.css">
    <style type="text/css">
        .css-form input.ng-invalid.ng-dirty {
        background-color: #FA787E;
        }
    
        .css-form input.ng-valid.ng-dirty {
        background-color: #78FA89;
        }
    </style>
        
    <script type="text/javascript" src="lib/jasmine/jasmine.js"></script>
    <script type="text/javascript" src="lib/jasmine/jasmine-html.js"></script>
    <!--    source file-->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.js"></script>
</head>
    <body>
        <div ng-app="form-example2">
            <div contentEditable="true" ng-model="content" title="Click to edit">Some</div>
            <pre>model = {{content}}</pre>
    
            <style type="text/css">
                div[contentEditable] {
                    cursor: pointer;
                    background-color: #D0D0D0;
                }
            </style>
            <script>
                angular.module('form-example2', []).directive('contenteditable', function () {
                    return {
                        require: 'ngModel',
                        link: function (scope, elm, attrs, ctrl) {
                            // view -> model
                            elm.bind('blur', function () {
                                scope.$apply(function () {
                                    ctrl.$setViewValue(elm.html());
                                });
                            });

                            // model -> view
                            ctrl.$render = function () {
                                elm.html(ctrl.$viewValue);
                            };

                            // load init value from DOM
                            ctrl.$setViewValue(elm.html());
                        }
                    };
                });

            </script>
        </div>
    </body>
</html>
